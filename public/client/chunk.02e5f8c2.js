import{n,s as t,E as s,F as e}from"./chunk.5985df63.js";const r=[];function c(n,t){return{subscribe:o(n,t).subscribe}}function o(s,e=n){let c;const o=[];function u(n){if(t(s,n)&&(s=n,c)){const n=!r.length;for(let n=0;n<o.length;n+=1){const t=o[n];t[1](),r.push(t,s)}if(n){for(let n=0;n<r.length;n+=2)r[n][0](r[n+1]);r.length=0}}}return{set:u,update:function(n){u(n(s))},subscribe:function(t,r=n){const i=[t,r];return o.push(i),1===o.length&&(c=e(u)||n),t(s),()=>{const n=o.indexOf(i);-1!==n&&o.splice(n,1),0===o.length&&(c(),c=null)}}}}function u(t,r,o){const u=!Array.isArray(t),i=u?[t]:t,f=r.length<2;return c(o,t=>{let c=!1;const o=[];let l=0,a=n;const h=()=>{if(l)return;a();const s=r(u?o[0]:o,t);f?t(s):a=e(s)?s:n},b=i.map((n,t)=>n.subscribe(n=>{o[t]=n,l&=~(1<<t),c&&h()},()=>{l|=1<<t}));return c=!0,h(),function(){s(b),a()}})}export{u as d,c as r,o as w};
